# syntax=docker/dockerfile:1
FROM gcr.io/distroless/static-debian12:nonroot
ARG TARGETPLATFORM

VOLUME /data
ENV PARSE_DMARC_CONFIG=/app/config.json \
    DATABASE_PATH=/data/parse-dmarc.db

COPY $TARGETPLATFORM/parse-dmarc /app/parse-dmarc

EXPOSE 8080

ENTRYPOINT ["/app/parse-dmarc"]
CMD ["--config=/app/config.json"]
